<script>
    document.addEventListener("DOMContentLoaded", function() {
        firebase.auth().onAuthStateChanged(async function(user) {
            if (!user) {
                window.location.href = "logreg.html";
                return;
            }
            const uid = user.uid;
            const snap = await firebase.database().ref('teachers/' + uid).once('value');
            const teacher = snap.val();
            if (!teacher || teacher.role !== "teacher") {
                document.getElementById('mainContent').style.display = "none";
                alert("Access denied.");
                await firebase.auth().signOut();
                window.location.href = "logreg.html";
            } else {
                document.getElementById('mainContent').style.display = "block";
            }
        });
    });
</script>
    
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700&family=Poppins:wght@500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../CSS/header.css">
    <link rel="stylesheet" href="../CSS/homepage4.css">
    <link rel="stylesheet" href="../CSS/footer.css">
    <link rel="stylesheet" href="../CSS/dropdown.css">
    <link rel="stylesheet" href="../CSS/burger.css">
    <link rel="icon" type="image/png" href="../images/icons/home.png" />
    <title>Home</title>

</head>

<body>
    <div id="mainContent" style="display:none;">
        
        <!-- Burger icon for mobile -->
        <button id="burgerBtn" class="burger-btn" aria-label="Open menu">
            <span></span>
            <span></span>
            <span></span>
        </button>
        
        <!-- Overlay for navbar -->
        <div class="sidebar-overlay" id="navOverlay"></div>

        <header>
            <div class="floating-elements">
                <div class="floating-element"></div>
                <div class="floating-element"></div>
                <div class="floating-element"></div>
                <div class="floating-element"></div>
            </div>
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <!-- Replace your logo-text div with this for per-letter bounce -->
                    <div class="logo-text">
                        <span>E</span><span>d</span><span>u</span><span>t</span><span>a</span><span>k</span><span>t</span><span>i</span><span>k</span><span>a</span>
                    </div>
                </div>
                <nav>
                    <ul>
                        <li><a href="homepage.html">Home</a></li>
                        <li class="dropdown">
                            <a href="#" class="dropbtn">Subject <i class="fa fa-caret-down"></i></a>
                            <ul class="dropdown-content">
                                <li><a href="subject_math.html">Math</a></li>
                                <li><a href="subject_english.html">English</a></li>
                                <li><a href="subject_science.html">Science</a></li>
                            </ul>
                        </li>
                        <li><a href="studentlist.html">Student</a></li>
                        <li class="dropdown">
                                <a href="#" class="dropbtn">Leaderboard <i class="fa fa-caret-down"></i></a>
                                <ul class="dropdown-content">
                                    <li><a href="leaderboard_math.html">Math</a></li>
                                    <li><a href="leaderboard_english.html">English</a></li>
                                    <li><a href="leaderboard_science.html">Science</a></li>
                                </ul>
                            </li>
                        <li>
                            <a href="#" id="profileBtn"><i class="fas fa-user-circle"></i> Profile</a>
                        </li>
                    </ul>
                </nav>
            </div>
        </header>

        
        <!-- Overlay for navbar -->
        <div class="sidebar-overlay" id="navOverlay"></div>
        <!-- Overlay for profile sidebar -->
        <div class="sidebar-overlay" id="profileSidebarOverlay"></div>

        <!-- Profile Sidebar (Dynamic with Firebase) -->
        <div id="profileSidebar" class="profile-sidebar">
            <div class="sidebar-content">
                <button class="close-btn" id="closeSidebar">&times;</button>
                <div style="position:relative; display:flex; flex-direction:column; align-items:center;">
                    <img class="profile-avatar" id="profileAvatar" src="https://api.dicebear.com/7.x/bottts/svg?seed=user" alt="Profile Avatar">
                    <i class="fa-solid fa-star sidebar-star" style="position:absolute; bottom:0; right:10px; color:#ffd700; font-size:1.2rem; background:white; border-radius:50%; padding:2px 4px; box-shadow:0 1px 4px #ffd70044;"></i>
                </div>
                <div class="profile-name" id="profileName">Loading...</div>
                <br>
                <div class="profile-info" style="width:100%;max-width:260px;margin-bottom:24px;">
                    <div class="profile-role" style="color:#2e8b57; font-weight:700; font-size:1.1rem; margin-bottom:8px; letter-spacing:1px; text-align:center;">
                    Teacher
                </div>
                    <div>
                        <i class="fa-solid fa-id-badge" style="color:violet;margin-right:10px;"></i>
                        <strong>ID:</strong> <span id="profileId">-</span>
                    </div>
                    <div>
                        <i class="fa-solid fa-user" style="color:#ff69b4;margin-right:10px;"></i>
                        <strong>First Name:</strong> <span id="profileFirstName">-</span>
                    </div>
                    <div>
                        <i class="fa-solid fa-user" style="color:#ffd700;margin-right:10px;"></i>
                        <strong>Middle Name:</strong> <span id="profileMiddleName">-</span>
                    </div>
                    <div>
                        <i class="fa-solid fa-user" style="color:#f14141;margin-right:10px;"></i>
                        <strong>Last Name:</strong> <span id="profileLastName">-</span>
                    </div>
                    <div>
                        <i class="fa-solid fa-graduation-cap" style="color:#2e8b57;margin-right:10px;"></i>
                        <strong>Grade Level:</strong> <span id="profileGrade">-</span>
                    </div>
                    <div>
                        <i class="fa-solid fa-apple-whole" style="color:#4faaff;margin-right:10px;"></i>
                        <strong>Section:</strong> <span id="profileSection">-</span>
                    </div>
                    <div>
            <i class="fas fa-map-marker-alt" style="color:#ff69b4;margin-right:10px;"></i>
            <strong>House/Street:</strong> <span id="profileAddressStreet">-</span>
        </div>
        <div>
            <i class="fas fa-map-marker-alt" style="color:#ffd700;margin-right:10px;"></i>
            <strong>Barangay:</strong> <span id="profileAddressBarangay">-</span>
        </div>
        <div>
            <i class="fas fa-map-marker-alt" style="color:#4faaff;margin-right:10px;"></i>
            <strong>City:</strong> <span id="profileAddressCity">-</span>
        </div>
        <div>
            <i class="fas fa-map-marker-alt" style="color:#2e8b57;margin-right:10px;"></i>
            <strong>Province:</strong> <span id="profileAddressProvince">-</span>
        </div>
        <div>
            <i class="fas fa-map-marker-alt" style="color:#f14141;margin-right:10px;"></i>
            <strong>ZIP:</strong> <span id="profileAddressZip">-</span>
        </div>
        <div>
            <i class="fas fa-map-marker-alt" style="color:violet;margin-right:10px;"></i>
            <strong>Region:</strong> <span id="profileAddressRegion">-</span>
        </div>
                </div>
                <div class="logout-switch-row">
                    <div class="logout-switch" id="logoutSwitch">
                        <div class="logout-switch-circle"></div>
                    </div>
                    <span class="logout-label" id="logoutLabel">LOGOUT</span>
                </div>
            </div>
        </div>

            <!-- Firebase App (the core Firebase SDK) -->
            <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
            <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
            <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>


            <script src="../assets/js/Teacher Side/profile.js"></script>
            

        <script src="../assets/js/Teacher Side/header.js"></script>

        <!--<div class="imgs">
            <img src="dinosaur.png" alt="">
        </div>-->

        <!-- Overview Section -->
        <section class="hero-new scroll-fade">
            <div class="hero-msg">
                <h1>Empowering Young Minds</h1>
                <div class="hero-highlight">
                EduTaktika turns Math, English, and Science into playful, interactive adventures
                with draggable tasks, visual aids, and instant feedback—reducing stress and
                boosting real understanding.
                </div>
            </div>
            <div class="hero-visual">
                <div class="hero-bubble"></div>
                <div class="hero-icon-pack">
                <div class="icon-tile"><i class="fas fa-calculator"></i></div>
                <div class="icon-tile"><i class="fas fa-spell-check"></i></div>
                <div class="icon-tile"><i class="fas fa-atom"></i></div>
                <div class="icon-tile"><i class="fas fa-lightbulb"></i></div>
                </div>
            </div>
        </section>

        <!-- Summary Section with Example Graphs -->
        <section class="summary-section scroll-fade" style="padding:60px 0;background:#f0f3f7;">
            <div class="section-title">
                <h2>Student Progress Summary</h2>
                <p>Visualize your students' learning journey with interactive progress graphs.</p>
            </div>
            <div style="max-width:1100px;margin:0 auto;display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:36px;padding:0 16px;">
                <div class="graph-card">
                    <h3>Overall Completion Rate</h3>
                    <canvas id="completionGraph" width="280" height="180"></canvas>
                </div>
                <div class="graph-card">
                    <h3>Average Scores per Subject</h3>
                    <canvas id="subjectGraph" width="280" height="180"></canvas>
                </div>
                <div class="graph-card">
                    <h3>Monthly Activity</h3>
                    <canvas id="monthlyGraph" width="280" height="180"></canvas>
                </div>
            </div>
        </section>

        <!-- Chart.js CDN -->
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script>
        // Example data for demonstration
        document.addEventListener("DOMContentLoaded", function() {
            // Completion Rate (Doughnut)
            new Chart(document.getElementById('completionGraph'), {
                type: 'doughnut',
                data: {
                    labels: ['Completed', 'Incomplete'],
                    datasets: [{
                        data: [78, 22],
                        backgroundColor: ['#2e8b57', '#e0e0e0'],
                        borderWidth: 1
                    }]
                },
                options: {
                    plugins: { legend: { display: true, position: 'bottom' } },
                    cutout: '70%',
                }
            });

            // Average Scores per Subject (Bar)
            new Chart(document.getElementById('subjectGraph'), {
                type: 'bar',
                data: {
                    labels: ['Math', 'English', 'Science'],
                    datasets: [{
                        label: 'Average Score',
                        data: [86, 91, 78],
                        backgroundColor: ['#4faaff', '#ffd700', '#f14141']
                    }]
                },
                options: {
                    plugins: { legend: { display: false } },
                    scales: { y: { beginAtZero: true, max: 100 } }
                }
            });

            // Monthly Activity (Line)
            new Chart(document.getElementById('monthlyGraph'), {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [{
                        label: 'Active Students',
                        data: [12, 18, 15, 22, 19, 25],
                        borderColor: '#2e8b57',
                        backgroundColor: 'rgba(46,139,87,0.1)',
                        fill: true,
                        tension: 0.3,
                        pointRadius: 4
                    }]
                },
                options: {
                    plugins: { legend: { display: false } },
                    scales: { y: { beginAtZero: true } }
                }
            });
        });
        </script>

        <!-- Mission & Vision Section -->
        <section class="scroll-fade mv" aria-labelledby="mvTitle">
        <div class="section-title" style="text-align:center;margin-top:10px;">
            <h2 id="mvTitle">Mission & Vision</h2>
            <p>Nurturing curious, confident learners through playful, meaningful exploration.</p>
        </div>
        <div class="mv-grid">
            <div class="mv-card2" tabindex="0" aria-label="Mission card (flip)">
            <div class="mv-inner">
                <div class="mv-face front">
                    <div class="mv-badge"><i class="fas fa-rocket"></i></div>
                    <h3>Mission</h3>
                    <p  style="font-family:'Outfit','Poppins',system-ui,sans-serif; ">Interactive game-based learning that keeps every student engaged while
                        empowering teachers with intuitive tools.</p>
                    <p style="font-size:.78rem;color:#555;">Flip to read more.</p>
                </div>
                <div class="mv-face back">
                    <h3>Mission+</h3>
                    <p style="font-family:'Outfit','Poppins',system-ui,sans-serif; " >We reduce learning anxiety, amplify curiosity, and support differentiated
                        pacing—so progress feels rewarding, not stressful.
                    </p>
                </div>
            </div>
            </div>
            <div class="mv-card2" tabindex="0" aria-label="Vision card (flip)">
            <div class="mv-inner">
                <div class="mv-face front">
                    <div class="mv-badge" style="color:var(--c-accent-alt);"><i class="fas fa-eye"></i></div>
                    <h3>Vision</h3>
                    <p style="font-family:'Outfit','Poppins',system-ui,sans-serif; ">A future where foundational subjects feel like creative puzzles—energizing
                        lifelong curiosity.</p>
                    <p style="font-size:.78rem;color:#555;">Flip to read more.</p>
                </div>
                <div class="mv-face back">
                    <h3>Vision+</h3>
                    <p style="font-family:'Outfit','Poppins',system-ui,sans-serif; ">Equitable, joyful learning spaces where every child sees progress and potential
                        through playful discovery.
                    </p>
                </div>
            </div>
            </div>
            <!--<div class="mv-card2" tabindex="0" aria-label="Values card (flip)">
            <div class="mv-inner">
                <div class="mv-face front">
                <div class="mv-badge" style="color:var(--c-accent);"><i class="fas fa-heart"></i></div>
                <h3>Values</h3>
                <p>Creativity, inclusion, transparency, and growth mindset in every interaction.</p>
                <p style="font-size:.78rem;color:#555;">Flip to read more.</p>
                </div>
                <div class="mv-face back">
                <h3>Values+</h3>
                <p>We design humane feedback loops; we celebrate small wins; we build safe,
                    positive digital classrooms.</p>
                </div>
            </div>
            </div>-->
        </div>
        </section>

            <!-- Benefits Section -->
        <section class="scroll-fade" aria-labelledby="benefitsTitle">
            <div class="benefits-wrapper">

                <div class="section-title" style="text-align:center;">
                    <h2 id="benefitsTitle">Why It Works</h2>
                    <p>Kid‑friendly mechanics + teacher insight = better retention, less pressure.</p>
                </div>

                <div class="benefit-grid">
                    <div class="benefit-card2">
                        <div class="benefit-icon"><i class="fas fa-gamepad"></i></div>
                        <h4>High Engagement</h4>
                        <p>Mini‑games + visual cues sustain focus and intrinsic motivation.</p>
                    </div>
                    <div class="benefit-card2">
                        <div class="benefit-icon" style="color:var(--c-accent-alt);"><i class="fas fa-smile"></i></div>
                        <h4>Less Stress</h4>
                        <p>Gentle pacing + retry loops remove fear of “wrong”.</p>
                    </div>
                    <div class="benefit-card2">
                        <div class="benefit-icon" style="color:var(--c-accent-alt2);"><i class="fas fa-chalkboard-teacher"></i></div>
                        <h4>Teacher Insight</h4>
                        <p>Progress snapshots highlight gaps early.</p>
                    </div>
                    <div class="benefit-card2">
                        <div class="benefit-icon" style="color:var(--c-accent);"><i class="fas fa-lightbulb"></i></div>
                        <h4>Concept Clarity</h4>
                        <p>Drag & drop + visuals reinforce abstract ideas concretely.</p>
                    </div>
                    <div class="benefit-card2">
                        <div class="benefit-icon" style="color:var(--c-accent-alt);"><i class="fas fa-hand-pointer"></i></div>
                        <h4>Active Learning</h4>
                        <p>Direct manipulation builds deeper cognitive links.</p>
                    </div>
                    <div class="benefit-card2">
                        <div class="benefit-icon" style="color:var(--c-accent-alt2);"><i class="fas fa-shield-alt"></i></div>
                        <h4>Safe & Private</h4>
                        <p>Structured roles + Firebase security for protected access.</p>
                    </div>
                </div>
            </div>
        </section>

    <footer>
            <div class="footer-content">
                <div class="footer-column">
                    <h3 class="edu">Eduktaktika</h3>
                    <p>
                        Making learning fun and engaging through interactive game-based
                        education.
                    </p>
                </div>
                <div class="footer-column" style="margin-left: 90px;">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="homepage.html">Home</a></li>
                        <li><a href="subject_english.html">Subject English</a></li>
                        <li><a href="subject_math.html">Subject Math</a></li>
                        <li><a href="subject_science.html">Subject Science</a></li>
                        <li><a href="studentlist.html">Student</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3></h3>
                    <ul>
                        <br>
                        <li><a href="leaderboard_math.html">Leaderboard Math</a></li>
                        <li><a href="leaderboard_english.html">Leaderboard English</a></li>
                        <li><a href="leaderboard_science.html">Leaderboard Science</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <div class="footer-links">
                    <a href="#"><i class="fab fa-facebook"></i></a>
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-youtube"></i></a>
                </div>
                <p>© 2025 Eduktaktika. All rights reserved.</p>
            </div>
        </footer>

        <script src="../assets/js/Teacher Side/editProfile.js"></script>

        <script>
        // --- ADVANCED SESSION MANAGEMENT FOR TEACHER HOMEPAGE ---

        // 1. Set Firebase Auth persistence to LOCAL (default, but explicit here)
        document.addEventListener("DOMContentLoaded", function() {
            function checkAuthReady(cb) {
                if (window.firebase && firebase.auth) cb();
                else setTimeout(() => checkAuthReady(cb), 100);
            }
            checkAuthReady(function() {
                // Set persistence (optional, but explicit)
                firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL).then(() => {
                    // 2. Listen for auth state changes
                    firebase.auth().onAuthStateChanged(function(user) {
                        if (!user) {
                            // Not logged in, redirect to login page
                            window.location.href = "logreg.html";
                        } else {
                            // 3. Optionally, check for custom claims/roles if needed
                            user.getIdTokenResult().then(idTokenResult => {
                                // Example: Only allow teachers
                                if (idTokenResult.claims.role && idTokenResult.claims.role !== "teacher") {
                                    alert("Access denied. Not a teacher account.");
                                    firebase.auth().signOut();
                                    window.location.href = "logreg.html";
                                }
                                // 4. Optionally, refresh token if needed (for long sessions)
                                // firebase.auth().currentUser.getIdToken(true);
                            });

                            // 5. Store session info in sessionStorage/localStorage for fast UI access
                            sessionStorage.setItem("edutaktikaUser", JSON.stringify({
                                uid: user.uid,
                                email: user.email,
                                displayName: user.displayName,
                                photoURL: user.photoURL
                            }));

                            // 6. Optionally, update UI with user info
                            if (document.getElementById('profileName')) {
                                document.getElementById('profileName').textContent = user.displayName || user.email;
                            }
                        }
                    });

                    // 7. Listen for storage events (multi-tab logout)
                    window.addEventListener('storage', function(e) {
                        if (e.key === 'firebase:authUser:' + firebase.app().options.apiKey + ':[DEFAULT]' && !e.newValue) {
                            // User logged out in another tab
                            window.location.href = "logreg.html";
                        }
                    });
                });
            });
        });
        </script>

        <script src="../assets/js/navbar.js"></script>
        <script>
        const io=new IntersectionObserver(es=>es.forEach(e=>{
        if(e.isIntersecting){e.target.classList.add('visible');io.unobserve(e.target);}
        }),{threshold:.18});
        document.querySelectorAll('.scroll-fade').forEach(el=>io.observe(el));
        </script>
    </div>
</body>

</html>