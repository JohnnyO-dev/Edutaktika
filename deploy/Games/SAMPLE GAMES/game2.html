<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sort the Animals by Habitat</title>
  <style>
  :root {
    --primary: #2e8b57;
    --secondary: #ffd700;
    --peach: #ff69b4;
    --forest-green: #3f4d34;
    --sun-yellow: #ffd700;
    --white: #ffffff;
}
    body { font-family: sans-serif; background: #e3f2fd; margin: 0; }
    h2 { text-align: center; margin-top: 32px; padding-top: 100px; }
    .game-area { display: flex; justify-content: center; gap: 60px; margin-top: 40px; }
    .habitat { background: #fff; border-radius: 16px; box-shadow: 0 4px 24px #0001; padding: 32px 24px; min-width: 220px; min-height: 220px; }
    .habitat-title { font-size: 22px; font-weight: bold; margin-bottom: 18px; text-align: center; }
    .animal { background: #ffe082; border-radius: 8px; padding: 10px 18px; margin-bottom: 12px; cursor: grab; font-size: 18px; display: flex; align-items: center; gap: 10px; }
    .animal img { width: 40px; height: 40px; border-radius: 8px; }
    .habitat.droppable { border: 2px dashed #90caf9; }
    .habitat.correct { background: #c8e6c9; border-color: #388e3c; }
    .habitat.incorrect { background: #ffcdd2; border-color: #d32f2f; }
    .score { text-align: center; margin-top: 24px; font-size: 20px; }
    #play-again-btn { margin-top: 24px; padding: 10px 28px; font-size: 18px; border-radius: 8px; background: #1976d2; color: #fff; border: none; cursor: pointer; }
    /* Modal styles */
    #modify-modal {
      display:none;
      position:fixed;
      top:50%;
      left:50%;
      transform:translate(-50%,-50%);
      background:#fff;
      border-radius:18px;
      box-shadow:0 12px 48px rgba(0,0,0,0.22);
      border:1px solid #ccc;
      padding:56px 48px 36px 48px;
      min-width:600px;
      max-width:90vw;
      z-index:100;
      font-size:20px;
    }
    #modify-modal h3 {
      margin-top:0;
      margin-bottom:32px;
      font-family:sans-serif;
      font-size:30px;
      font-weight:700;
    }
    #animal-list {
      max-height: 300px;
      overflow-y: auto;
      margin-bottom: 32px;
    }
    .animal-mod {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      border-bottom: 1px solid #eee;
    }
    .animal-mod:last-child {
      border-bottom: none;
    }
    .animal-mod img {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 12px;
    }
    .animal-mod-name {
      flex-grow: 1;
      font-size: 18px;
    }
    .animal-mod-habitat {
      font-size: 16px;
      color: #666;
    }
    .animal-mod button {
      padding: 6px 12px;
      font-size: 16px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .animal-mod button.edit {
      background: #ffa726;
      color: #fff;
    }
    .animal-mod button.remove {
      background: #e57373;
      color: #fff;
    }
  </style>
</head>
<body>
  <h2>Sort the Animals by Habitat!</h2>
  <div class="game-area" id="game-area"></div>
  <div class="score"></div>
  <button id="play-again-btn" style="display:none;">Play Again</button>
  <button id="modify-game-btn" style="position: absolute; top: 10px; right: 10px; z-index: 10;">Modify Game</button>
  <div id="animals" style="display:flex; justify-content:center; gap:18px; margin-top:32px;"></div>

  <!-- Modify Modal -->
  <div id="modify-modal" style="
    display:none;
    position:fixed;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    background:#fff;
    border-radius:18px;
    box-shadow:0 12px 48px rgba(0,0,0,0.22);
    border:1px solid #ccc;
    padding:56px 48px 36px 48px;
    min-width:600px;
    max-width:90vw;
    z-index:100;
    font-size:20px;
  ">
    <h3 style="margin-top:0; margin-bottom:32px; font-family:sans-serif; font-size:30px; font-weight:700;">Modify Animals</h3>
    <div id="animal-list"></div>
    <div style="text-align:right; margin-top:32px;">
      <button id="save-modifications" style="padding:14px 36px; border-radius:8px; background:#1769ff; color:#fff; border:none; margin-right:16px; font-size:20px; font-weight:600;">Save</button>
      <button id="close-modal" style="padding:14px 36px; border-radius:8px; background:#eee; color:#333; border:none; font-size:20px; font-weight:600;">Close</button>
    </div>
  </div>

  <script>
    // Animal data
    const animals = [
      { name: "Lion", habitat: "Forest", img: "https://upload.wikimedia.org/wikipedia/commons/7/73/Lion_waiting_in_Namibia.jpg" },
      { name: "Camel", habitat: "Desert", img: "https://files.worldwildlife.org/wwfcmsprod/images/camel/blog_photo_section/5np6j2xwbl_camelenews_1050.jpg" },
      { name: "Dolphin", habitat: "Ocean", img: "https://upload.wikimedia.org/wikipedia/commons/6/6e/Dolphin_in_the_water.jpg" },
      { name: "Fox", habitat: "Forest", img: "https://upload.wikimedia.org/wikipedia/commons/1/16/Fox_-_British_Wildlife_Centre_%282%29.jpg" },
      { name: "Octopus", habitat: "Ocean", img: "https://upload.wikimedia.org/wikipedia/commons/6/6b/Octopus2.jpg" },
      { name: "Lizard", habitat: "Desert", img: "https://upload.wikimedia.org/wikipedia/commons/7/7e/Lizard_in_the_desert.jpg" }
    ];

    let habitats = [
      { key: "Forest", name: "Forest" },
      { key: "Ocean", name: "Ocean" },
      { key: "Desert", name: "Desert" }
    ];

    let correct = 0, total = 0;

    function startGame() {
      correct = 0; total = 0;
      document.querySelector('.score').textContent = '';
      document.getElementById('play-again-btn').style.display = 'none';

      // Render habitats dynamically
      const gameArea = document.getElementById('game-area');
      gameArea.innerHTML = '';
      habitats.forEach(h => {
        const div = document.createElement('div');
        div.className = 'habitat droppable';
        div.dataset.habitat = h.key;
        div.innerHTML = `<div class="habitat-title">${h.name}</div>`;
        gameArea.appendChild(div);
      });

      // Reset habitats
      document.querySelectorAll('.habitat').forEach(h => {
        h.classList.remove('correct', 'incorrect');
      });

      // Shuffle animals
      const shuffled = animals.sort(() => Math.random() - 0.5);
      const animalsDiv = document.getElementById('animals');
      animalsDiv.innerHTML = '';
      shuffled.forEach(animal => {
        const div = document.createElement('div');
        div.className = 'animal';
        div.draggable = true;
        div.dataset.habitat = animal.habitat;
        div.dataset.name = animal.name;
        div.innerHTML = `<img src="${animal.img}" alt="${animal.name}"><span>${animal.name}</span>`;
        animalsDiv.appendChild(div);
      });

      // Drag events
      document.querySelectorAll('.animal').forEach(div => {
        div.ondragstart = function(e) {
          e.dataTransfer.setData('text', JSON.stringify({ name: this.dataset.name, habitat: this.dataset.habitat }));
        };
      });

      // Drop events
      document.querySelectorAll('.habitat').forEach(habitatDiv => {
        habitatDiv.ondragover = e => e.preventDefault();
        habitatDiv.ondrop = function(e) {
          e.preventDefault();
          const data = JSON.parse(e.dataTransfer.getData('text'));
          total++;
          if (this.dataset.habitat === data.habitat) {
            this.classList.add('correct');
            this.innerHTML += `<div style="margin-top:10px;"><img src="${animals.find(a => a.name === data.name).img}" style="width:32px; height:32px; vertical-align:middle;"> ${data.name}</div>`;
            correct++;
          } else {
            this.classList.add('incorrect');
            setTimeout(() => this.classList.remove('incorrect'), 800);
          }
          // Remove dragged animal
          document.querySelectorAll('.animal').forEach(a => {
            if (a.dataset.name === data.name) a.draggable = false;
          });
          updateScore();
        };
      });
    }

    function updateScore() {
      document.querySelector('.score').textContent = `Score: ${correct} / ${animals.length}`;
      if (correct === animals.length) {
        document.getElementById('play-again-btn').style.display = 'inline-block';
      }
    }

    document.getElementById('play-again-btn').onclick = startGame;

    // Modify game button
    document.getElementById('modify-game-btn').onclick = function() {
      const modal = document.getElementById('modify-modal');
      const animalList = document.getElementById('animal-list');
      animalList.innerHTML = '';

      // Habitat name editing section
      animalList.innerHTML += `<div style="margin-bottom:24px;">
        <strong>Edit Habitat Names:</strong><br>
        ${habitats.map((h, i) => `
          <input type="text" id="habitatName${i}" value="${h.name}" style="font-size:18px; margin-right:12px; width:120px;">
        `).join('')}
      </div>`;

      // Animal editing section
      animals.forEach((animal, i) => {
        const div = document.createElement('div');
        div.className = 'animal-mod';
        div.innerHTML = `
  <div style="display:flex; align-items:center;">
    <img id="preview${i}" src="${animal.img}" alt="${animal.name}">
    <input type="text" id="name${i}" value="${animal.name}" style="font-size:18px; margin-right:12px; width:110px;">
    <select id="habitat${i}" style="font-size:16px;">
      ${habitats.map(h => `<option value="${h.key}" ${animal.habitat === h.key ? "selected" : ""}>${h.name}</option>`).join('')}
    </select>
    <label style="font-size:16px; font-weight:500; margin-left:12px;">Image</label>
    <input type="file" accept="image/*" id="img${i}" style="width:170px; font-size:16px;">
  </div>
  <div>
    <button class="remove" style="margin-top:8px;">Remove</button>
  </div>
        `;
        animalList.appendChild(div);

        // Image upload logic
        const fileInput = div.querySelector(`#img${i}`);
const previewImg = div.querySelector(`#preview${i}`);
fileInput.addEventListener("change", (e) => {
  const file = e.target.files[0];
  if (file) {
    const reader = new FileReader();
    reader.onload = function(evt) {
      previewImg.src = evt.target.result;
    };
    reader.readAsDataURL(file);
  }
});

        // Remove button logic
        div.querySelector('.remove').onclick = () => {
          if (confirm(`Remove ${animal.name} from game?`)) {
            animals.splice(i, 1);
            document.getElementById('modify-game-btn').onclick(); // Refresh modal
            startGame(); // Restart game after removal
          }
        };
      });

      modal.style.display = 'block';
    };

    // Close modal
    document.getElementById('close-modal').onclick = function() {
      document.getElementById('modify-modal').style.display = 'none';
    };

    // Load animals and habitats from localStorage if available
if (localStorage.getItem('animalSortAnimals')) {
    animals.length = 0;
    animals.push(...JSON.parse(localStorage.getItem('animalSortAnimals')));
}
if (localStorage.getItem('animalSortHabitats')) {
    habitats.length = 0;
    habitats.push(...JSON.parse(localStorage.getItem('animalSortHabitats')));
}

// Save edits to localStorage
document.getElementById('save-modifications').onclick = function() {
    habitats.forEach((h, i) => {
        h.name = document.getElementById(`habitatName${i}`).value;
    });
    animals.forEach((animal, i) => {
        animal.name = document.getElementById(`name${i}`).value;
        animal.habitat = document.getElementById(`habitat${i}`).value;
        const previewImg = document.getElementById(`preview${i}`);
        animal.img = previewImg.src;
    });
    localStorage.setItem('animalSortAnimals', JSON.stringify(animals)); // <-- Save here
    localStorage.setItem('animalSortHabitats', JSON.stringify(habitats)); // <-- Save here
    document.getElementById('modify-modal').style.display = 'none';
    startGame();
};

    startGame();
  </script>
</body>
</html>